{% load comments %}
{% load signup_extras %}

<a id="comments"></a><h3>{{ constituency.name }} discussion</h3>
<p class="quiet">Discuss with other people what you're doing in this constituency</p>
{% get_comment_form for constituency as form %}
<form action="{% comment_form_target %}" method="post" id="post-comment">
  {{ form.content_type }}
  {{ form.object_pk }}
  {{ form.timestamp }}
  {{ form.security_hash }}
  <input type="hidden" name="next" value="{{ request.path }}#comments" />
  <input id="id_comment" name="comment" value="write here" onfocus="if(this.value=='write here') { this.value='' }" onblur="if(this.value==''){ this.value='write here'; }" maxlength="3000" type="text"> <input name="post" class="submit-post" value="post" type="submit">

  <p style="display: none; margin:0;">
    <label for="id_honeypot">If you enter anything in this field your comment will be treated as spam</label> {{ form.honeypot }}
  </p>
</form>

{% get_comment_list for constituency as comment_list %}
<div class="comments">
{% for comment in comment_list %}
    <div class="comment">
        {#{% ifequal comment.user user %}<a href='#' style="float:right;">delete</a>{% endifequal %}#}
        {% if perms.delete_comment %}<a href='{% url custom_comment_delete comment.id,request.path %}' class="comment_action">delete</a>{% endif %}
        <span class="poster">{{ comment.user.display_name }}</span>
        <span class="text">{{ comment.comment }}</span>
        <span class="time">{{ comment.submit_date|naturalTimeDifference }}</span>
    </div>
{% empty %}
    <div class="comment">There are no messages for {{ constituency.name }} yet, be the first!</div>
{% endfor %}
</div>

{% extends 'base.html' %}

{% load signup_extras %}

{% block title %}Moderate local issues{% endblock %}

{% block extra-head %}
<link rel="stylesheet" type="text/css"  media="screen" href="{{ MEDIA_URL }}issues/issues.css" />
{% endblock %}

{% block content %}
<div class="span-8 last task">
{% if submitted %}
 <div style="padding:0.5em;border:1px solid #EEE;margin-top:1em;margin-bottom:1em;">
    <h3 style="margin-top:0">Thank you for moderating an issue!</h3>
    Please carry on :)
 </div>
{% else %}
 <h3>
  Moderate local issues
 </h3>
{% endif %}

{% if form %}
    <form action="" method="post" id="moderate_issue">
        <p>If necessary, rewrite the issue such that it is:
            <ul>
                <li>A statement for which it is possible for somebody to
                record agreement/disagreement/no opinion.</li>
                <li>It should be a proper sentence, with a leading capital and 
                a full stop.</li>
                <li>If forward looking, the statement should argue for a
                specific change to current or planned policy (e.g. "increase funding to provide a service",
                not simply "provide a service")
                </li>
                <li>If backward looking, the statement should not aportion blame, but simply describe
                   an alternative decision.</li>
                <li>It should be a local issue.</li>
                <li>If the issue mentions a public body, check it is the right one (e.g. has the powers
                ascribed to it).</li>
                </li>
            </li>
            Use the source link! It will often explain what the issue is.
        </p>
        <div class="fieldWrapper">
            {{ form.constituency.errors }}
            {{ form.question.errors }}
            <label for="id_question">
                {{ issue.constituency.name }} 
            </label>
            <br>{{ form.question }}
        </div>
        <div class="fieldWrapper">
            {{ form.reference_url.errors }}
            You may have a good issue and a bad source. We encourage
            you to change the source.
            <label for="id_reference_url">
                Source
            </label>
            {{ form.reference_url }}
            <a href="{{ issue.reference_url }}">follow link</a>
        </div>
        <input type="hidden" name="id" value="{{ issue.id }}" />
        <input type="submit" value="Approve" id="id_approve" name="Approve" /> 
        <input type="submit" value="Junk" id="id_save" name="Junk" /> 
        <p>If you don't like this issue, refresh the page for a new one.</p>
    </form>
{% endif %}
 <p></p>
</div>

<hr/>

<div class="span-4 last">
 <h3>Existing issues in {{ constituency.name }}</h3>
{% if issues %}
 <ul>
 {% for issue in issues %}
  <li>{{ issue.question }}{% if issue.reference_url %} (<a href="{{ issue.reference_url }}" target="_blank">source</a>){% endif %}</li>
 {% endfor %}
 </ul>
{% else %}
<ul>
    <li>Nobody has added any issues here yet</li>
</ul>
{% endif %}
</div>

{% endblock %}
